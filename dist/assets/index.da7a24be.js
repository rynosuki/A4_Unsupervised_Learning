(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerpolicy&&(r.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?r.credentials="include":t.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(t){if(t.ep)return;t.ep=!0;const r=n(t);fetch(t.href,r)}})();class o{constructor(e){this.currentUser=void 0,this.timeTaken=0,this.timeCurrent=0,this.state=e,this.currentTimer=void 0,this.logicLeaderboard()}logicLeaderboard(){if(console.log(localStorage.getItem("topList")),localStorage.getItem("topList")===null){const e=[];e.push({name:"undefined",score:999}),e.push({name:"undefined",score:999}),e.push({name:"undefined",score:999}),e.push({name:"undefined",score:999}),e.push({name:"undefined",score:999}),localStorage.setItem("topList",JSON.stringify(e))}}updateLeaderboard(){let e=JSON.parse(localStorage.getItem("topList"));console.log(e),e.push({name:this.currentUser,score:Math.floor(this.timeCurrent/1e3)}),e.sort((n,s)=>n.score-s.score),e=e.slice(0,5),localStorage.setItem("topList",JSON.stringify(e))}initTimer(){const e=Date.now();this.currentTimer=setInterval(()=>{this.timeCurrent=Date.now()-e,document.getElementById("timer").innerHTML="Time left: "+Math.floor((1e4-this.timeCurrent)/1e3),(1e4-this.timeCurrent)/1e3<0&&(this.state.changeState(this.state.gameStates.GameLost),clearInterval(this.currentTimer))},1e3)}questionAnswered(){this.timeTaken+=this.timeCurrent,clearInterval(this.currentTimer)}setName(){this.currentUser=document.getElementById("Input-Text").value}reset(){this.currentUser=void 0,this.timeTaken=0}}class d{constructor(e){this.workDiv=document.getElementsByClassName("Main")[0],this.state=e,this.renderLeaderboardButton(),this.showLeaderboard=!1}renderStart(){const e=this.createElement({type:"div",className:"Information-Wrapper"});e.append(this.createElement({type:"h1",innerHTML:"Welcome to Quiz"})),e.append(this.createElement({type:"button",id:"Event-Button",innerHTML:"Start"})),this.workDiv.innerHTML=e.outerHTML,document.getElementById("Event-Button").addEventListener("click",()=>this.state.changeState(this.state.gameStates.NameChoice))}renderNameRequest(){const e=this.createElement({type:"div",className:"Information-Wrapper"});e.append(this.createElement({type:"h1",innerHTML:"Enter your name:"})),e.append(this.createElement({type:"input",style:"text",id:"Input-Text",name:"answer"})),e.append(this.createElement({type:"button",id:"Event-Submit",innerHTML:"Submit"})),this.workDiv.innerHTML=e.outerHTML,document.getElementById("Event-Submit").addEventListener("click",()=>this.state.changeState(this.state.gameStates.Question))}renderQuestion(e,n){const s=this.createElement({type:"div"});let t=this.createElement({type:"div",className:"Information-Wrapper"});t.append(this.createElement({type:"h1",innerHTML:e})),t.append(this.createElement({type:"p",id:"timer",innerHTML:"Time left: 10"})),s.append(t),t=this.createElement({type:"div",className:"Form-Wrapper"});const r=this.createElement({type:"form",className:"Form-Details"});r.append(this.renderAnswers(n)),r.append(this.createElement({type:"button",id:"Event-Submit",innerHTML:"Submit"})),t.appendChild(r),s.append(t),this.workDiv.innerHTML=s.outerHTML,document.getElementById("Event-Submit").addEventListener("click",i=>{i.preventDefault(),this.state.changeState(this.state.gameStates.Answered)})}renderAnswered(){const e=this.createElement({type:"div",className:"Information-Wrapper"});e.append(this.createElement({type:"h1",innerHTML:"You answered correctly!"})),e.append(this.createElement({type:"button",id:"Event-Submit",innerHTML:"Next Question"})),this.workDiv.innerHTML=e.outerHTML,document.getElementById("Event-Submit").addEventListener("click",()=>this.state.changeState(this.state.gameStates.Question))}renderGameLost(){const e=this.createElement({type:"div",className:"Information-Wrapper"});e.append(this.createElement({type:"h1",innerHTML:"You lost!"})),e.append(this.createElement({type:"button",id:"Event-Submit",innerHTML:"Restart"})),this.workDiv.innerHTML=e.outerHTML,document.getElementById("Event-Submit").addEventListener("click",()=>this.state.changeState(this.state.gameStates.Start))}renderGameWon(e){const n=this.createElement({type:"div",className:"Information-Wrapper"});n.append(this.createElement({type:"h1",innerHTML:"You won in "+e+" seconds"})),n.append(this.createElement({type:"button",id:"Event-Submit",innerHTML:"Play again!"})),this.workDiv.innerHTML=n.outerHTML,document.getElementById("Event-Submit").addEventListener("click",()=>this.state.changeState(this.state.gameStates.Start))}renderLeaderboardButton(){document.getElementsByClassName("Leaderboard")[0].addEventListener("click",n=>{this.renderLeaderboard()})}renderLeaderboard(){const e=this.createElement({type:"div",className:"leaderBoard"}),n=JSON.parse(localStorage.getItem("topList"));e.append(this.createElement({type:"h1",innerHTML:"Leaderboard"}));for(let r=0;r<n.length;r++)e.append(this.createElement({type:"p",innerHTML:r+1+". "+n[r].name+" - "+n[r].score}));const s=document.getElementsByClassName("Show-Leaderboard")[0],t=document.getElementsByClassName("Leaderboard")[0];if(!this.showLeaderboard)s.appendChild(e),this.showLeaderboard=!this.showLeaderboard,t.className="Leaderboard active";else{let r=s.lastElementChild;for(;r;)s.removeChild(r),r=s.lastElementChild;this.showLeaderboard=!this.showLeaderboard,t.className="Leaderboard"}}renderAnswers(e=void 0){if(e===void 0)return this.createElement({type:"input",style:"text",id:"input",name:"answer"});{const n=this.createElement({type:"div"});for(const s of Object.keys(e)){const t=this.createElement({type:"div",id:"answerDiv"});t.append(this.createElement({type:"label",innerHTML:e[s],htmlFor:s})),t.append(this.createElement({type:"input",style:"radio",name:"answer",id:s,value:s})),n.append(t)}return n}}createElement(e){const n=document.createElement(e.type);return e.style!==void 0&&(n.type=e.style),e.id!==void 0&&(n.id=e.id),e.innerHTML!==void 0&&(n.innerHTML=e.innerHTML),e.value!==void 0&&(n.value=e.value),e.name!==void 0&&(n.name=e.name),e.className!==void 0&&(n.className=e.className),e.htmlFor!==void 0&&(n.htmlFor=e.htmlFor),n}}class c{constructor(){this.currentQuestion=void 0}async getQuestion(e){return this.currentQuestion=await fetch(e).then(n=>n.json()),this.currentQuestion}async postAnswer(e,n={}){return await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(s=>s.ok?s.json():!1)}}class h{constructor(e){this.game=e,this.gameStates={Start:0,Question:1,Answered:2,GameLost:3,GameWon:4,NameChoice:5},this.prevState=void 0,this.currentGameState=this.gameStates.Start}changeState(e){this.prevState=this.currentGameState,this.currentGameState=e,this.game.runGame(this.currentGameState)}}class l{constructor(){this.startURL="https://courselab.lnu.se/quiz/question/1",this.nextURL="https://courselab.lnu.se/quiz/question/1",this.state=new h(this),this.logic=new o(this.state),this.render=new d(this.state),this.post=new c}async runGame(e=this.state.gameStates.Start){let n,s;switch(e){case this.state.gameStates.Start:this.nextURL=this.startURL,this.logic.reset(),this.render.renderStart();break;case this.state.gameStates.Question:this.state.prevState===this.state.gameStates.NameChoice&&this.logic.setName(),this.post.getQuestion(this.nextURL).then(t=>{this.nextURL=t.nextURL,this.render.renderQuestion(t.question,t.alternatives),this.logic.initTimer()});break;case this.state.gameStates.Answered:this.logic.questionAnswered(),this.post.currentQuestion.alternatives===void 0?n=document.getElementById("input").value:document.getElementsByName("answer").forEach(t=>{t.checked&&(n=t.value)}),(s=await this.post.postAnswer(this.nextURL,{answer:n}))===!1?this.state.changeState(this.state.gameStates.GameLost):s.nextURL===void 0?(console.log(s),this.state.changeState(this.state.gameStates.GameWon)):(this.nextURL=s.nextURL,this.render.renderAnswered());break;case this.state.gameStates.GameLost:this.render.renderGameLost();break;case this.state.gameStates.GameWon:this.render.renderGameWon(Math.floor(this.logic.timeTaken/1e3)),this.logic.updateLeaderboard();break;case this.state.gameStates.NameChoice:this.render.renderNameRequest();break}}}const m=new l;m.runGame();
